# PATCH FOR play_preview_thread in main_window.py
# Add these lines after: cap = cv2.VideoCapture(filepath)
# Around line 1562

# ========== ADD AFTER LINE 1562 ==========
        
        # Get video info for player controls (NEW)
        self.video_total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
        self.video_fps = cap.get(cv2.CAP_PROP_FPS) or 24.0

# ========== ADD AFTER "if self.preview_id != thread_id: break" ==========
# Around line 1574

            # Handle Pause (NEW)
            while self.is_paused and not self.stop_preview:
                time.sleep(0.1)
                if self.preview_id != thread_id:
                    break
            
            # Handle Seek (NEW)
            if self.seeking:
                try:
                    cap.set(cv2.CAP_PROP_POS_FRAMES, self.seek_target_frame)
                    frame_count = self.seek_target_frame
                    self.seeking = False
                except:
                    self.seeking = False

# ========== ADD AFTER "frame_count += 1" ==========
# Around line 1589

            # Update seek bar and time display (NEW)
            current_frame = int(cap.get(cv2.CAP_PROP_POS_FRAMES))
            self.video_current_frame = current_frame
            if self.video_total_frames > 0:
                seek_percent = (current_frame / self.video_total_frames) * 100
                self.root.after(0, lambda p=seek_percent: self.seek_var.set(p))
                
                current_time = current_frame / self.video_fps if self.video_fps > 0 else 0
                total_time = self.video_total_frames / self.video_fps if self.video_fps > 0 else 0
                time_text = f"{self.format_time(current_time)} / {self.format_time(total_time)}"
                self.root.after(0, lambda t=time_text: self.time_label.config(text=t))
